soybean_data <- soybean_data |>
mutate(Plantio = case_when(
Plantio == "2022-01-17" ~ as.Date("2022-11-17"),
Plantio == "2021-11-23" ~ as.Date("2022-11-23"),
TRUE ~ as.Date(Plantio)),
Colheita = Plantio+Ciclo)
# creating the harvest cycle categorical covariate
# criando a covariável categórica de ciclo de colheita
soybean_data <- soybean_data |>
mutate(Ciclo4 = cut(x = Ciclo, breaks = c(-Inf, 100, 110, 120, Inf),
labels = c("Super Precoce","Precoce","Medio","Tardio"))) |>
# creating an identifier
mutate(idCombi = as.factor(paste(Local, Ano, Ciclo4, sep = "_")),
id = as.numeric(idCombi))
# creating oceanic season variable
soybean_data <- soybean_data |>
mutate(Temp = case_when(
year(Plantio) == 2017 & month(Plantio) == 11 & year(Colheita) == 2018 & month(Colheita) == 3 ~ mean(-0.7,-0.8,-1.0,-0.9,-0.9,-0.7,-0.5),
year(Plantio) == 2017 & month(Plantio) == 11 & year(Colheita) == 2018 & month(Colheita) == 4 ~ mean(-0.7,-0.8,-1.0,-0.9,-0.9,-0.7,-0.5,-0.2),
year(Plantio) == 2017 & month(Plantio) == 11 & year(Colheita) == 2018 & month(Colheita) == 2 ~ mean(-0.7,-0.8,-1.0,-0.9,-0.9,-0.7),
year(Plantio) == 2017 & month(Plantio) == 12 & year(Colheita) == 2018 & month(Colheita) == 3 ~ mean(-0.8,-1.0,-0.9,-0.9,-0.7,-0.5),
year(Plantio) == 2017 & month(Plantio) == 12 & year(Colheita) == 2018 & month(Colheita) == 4 ~ mean(-0.8,-1.0,-0.9,-0.9,-0.7,-0.5,-0.2),
year(Plantio) == 2019 & month(Plantio) == 11 & year(Colheita) == 2020 & month(Colheita) == 2 ~ mean(0.3,0.5,0.5,0.5,0.5,0.4),
year(Plantio) == 2019 & month(Plantio) == 11 & year(Colheita) == 2020 & month(Colheita) == 3 ~ mean(0.3,0.5,0.5,0.5,0.5,0.4,0.2),
year(Plantio) == 2020 & month(Plantio) == 11 & year(Colheita) == 2021 & month(Colheita) == 2 ~ mean(-1.2,-1.3,-1.2,-1.0,-0.9,-0.8),
year(Plantio) == 2020 & month(Plantio) == 11 & year(Colheita) == 2021 & month(Colheita) == 3 ~ mean(-1.2,-1.3,-1.2,-1.0,-0.9,-0.8,-0.7),
year(Plantio) == 2021 & month(Plantio) == 10 & year(Colheita) == 2022 & month(Colheita) == 2 ~ mean(-0.7,-0.8,-1.0,-1.0,-1.0,-0.9,-1.0),
year(Plantio) == 2021 & month(Plantio) == 11 & year(Colheita) == 2022 & month(Colheita) == 3 ~ mean(-0.8,-1.0,-1.0,-1.0,-0.9,-1.0,-1.1),
year(Plantio) == 2022 & month(Plantio) == 11 & year(Colheita) == 2023 & month(Colheita) == 2 ~ mean(-1.0,-0.9,-0.8,-0.7,-0.4,-0.1),
year(Plantio) == 2022 & month(Plantio) == 11 & year(Colheita) == 2023 & month(Colheita) == 3 ~ mean(-1.0,-0.9,-0.8,-0.7,-0.4,-0.1,0.2),
)) |>
mutate(Caracteristica = cut(Temp, breaks = c(-2, -0.5, 0.5), labels = c("LaNina", "Neutro")))
# row number
soybean_data <- soybean_data |> mutate(nrow = 1:nrow(soybean_data))
# excluding outliers from the dataset
soybean_data <- soybean_data[-c(265, 289, 316, 374, 770),]
attach(soybean_data)
?facet_grid
ggplot(soybean_data, aes(x = Caracteristica, y = kgha)) +
geom_boxplot() + facet_grid(Solo~Ciclo4) +
theme_light()
mod1.lm <- lm(formula = kgha ~ Solo*Ciclo4*Caracteristica, data = soybean_data)
summary(mod1.lm)
plot(mod1.lm)
mod1.lme <- nlme(model = kgha ~ Solo*Ciclo4*Caracteristica, data = soybean_data,
random = ~1|Cultivar)
mod1.lme <- lme(fixed = kgha ~ Solo*Ciclo4*Caracteristica, data = soybean_data,
random = ~1|Cultivar)
summary(mod1.lme)
summary(mod1.lme)
tseries::jarque.bera.test(residuals(mod1.lme))
car::leveneTest(residuals(mod1.lme) ~ Cultivar)
# modelo misto com interações duplas
mod2.lme <- lme(fixed = kgha ~ Solo*Ciclo4 + Solo*Caracteristica + Ciclo4*Caracteristica,
data = soybean_data, random = ~1|Cultivar)
summary(mod2.lme)
tseries::jarque.bera.test(residuals(mod2.lme))
car::leveneTest(residuals(mod2.lme) ~ Cultivar)
summary(mod2.lme)
# testando os coeficientes não significantes do mod2.lme
coefID <- c(7,10,12,13)
coefNAM <- names(fixef(mod2.lme)[coefID])
Cmatrix <- matrix(0,3,13)
Cmatrix[cbind(1:3,coefID)] <- 1
Cmatrix <- matrix(0,4,13)
Cmatrix[cbind(1:4,coefID)] <- 1
rownames(Cmatrix) <- coefNAM
GLH <- multcomp::glht(model = mod2.lme, linfct = Cmatrix)
summary(GLH) # não significativos
summary(mod1.lme)
# testando os coeficientes não significantes do mod2.lme
coefID <- c(7,10,12,13,14,15,16)
coefNAM <- names(fixef(mod2.lme)[coefID])
Cmatrix <- matrix(0,7,13)
Cmatrix[cbind(1:7,coefID)] <- 1
Cmatrix <- matrix(0,7,16)
Cmatrix[cbind(1:7,coefID)] <- 1
rownames(Cmatrix) <- coefNAM
GLH <- multcomp::glht(model = mod2.lme, linfct = Cmatrix)
GLH <- multcomp::glht(model = mod1.lme, linfct = Cmatrix)
summary(GLH) # não significativos
summary(mod2.lme)
# modelo misto sem interação dupla do Solo com Característica
mod3.lme <- lme(fixed = kgha ~ Solo*Ciclo4 + Ciclo4*Caracteristica,
data = soybean_data, random = ~1|Cultivar)
summary(mod3.lme)
length(mod3.lme$coefficients)
length(mod3.lme$coefficients$fixed)
tseries::jarque.bera.test(residuals(mod3.lme))
car::leveneTest(residuals(mod3.lme) ~ Cultivar)
# testando os coeficientes não significantes do mod3.lme
coefID <- c(7,11,12)
coefNAM <- names(fixef(mod3.lme)[coefID])
Cmatrix <- matrix(0,3,12)
Cmatrix[cbind(1:3,coefID)] <- 1
rownames(Cmatrix) <- coefNAM
GLH <- multcomp::glht(model = mod3.lme, linfct = Cmatrix)
summary(GLH) # coeficientes não significativos
# modelo misto com covar de Grupo
mod4.lme <- lme(fixed = kgha ~ Grupo, data = soybean_data, random = ~1|Cultivar)
# creating Group variable of interactions Solo, Ciclo and Caracteristica
soybean_data <- soybean_data |>
#mutate(tha = kgha/1000) |>
mutate(Grupo = case_when(
Solo == "Latossolo" & Ciclo4 == "Super Precoce" & Caracteristica == "LaNina" ~ "G1",
Solo == "Latossolo" & Ciclo4 == "Super Precoce" & Caracteristica == "Neutro" ~ "G2",
Solo == "Plintossolo" & Ciclo4 == "Super Precoce" & Caracteristica == "LaNina" ~ "G3",
Solo == "Plintossolo" & Ciclo4 == "Super Precoce" & Caracteristica == "Neutro" ~ "G4",
Solo == "Latossolo" & Ciclo4 == "Precoce" & Caracteristica == "LaNina" ~ "G5",
Solo == "Latossolo" & Ciclo4 == "Precoce" & Caracteristica == "Neutro" ~ "G6",
Solo == "Plintossolo" & Ciclo4 == "Precoce" & Caracteristica == "LaNina" ~ "G7",
Solo == "Plintossolo" & Ciclo4 == "Precoce" & Caracteristica == "Neutro" ~ "G8",
Solo == "Latossolo" & Ciclo4 == "Medio" & Caracteristica == "LaNina" ~ "G9",
Solo == "Latossolo" & Ciclo4 == "Medio" & Caracteristica == "Neutro" ~ "G10",
Solo == "Plintossolo" & Ciclo4 == "Medio" & Caracteristica == "LaNina" ~ "G11",
Solo == "Plintossolo" & Ciclo4 == "Medio" & Caracteristica == "Neutro" ~ "G12",
Solo == "Latossolo" & Ciclo4 == "Tardio" & Caracteristica == "LaNina" ~ "G13",
Solo == "Latossolo" & Ciclo4 == "Tardio" & Caracteristica == "Neutro" ~ "G14",
Solo == "Plintossolo" & Ciclo4 == "Tardio" & Caracteristica == "LaNina" ~ "G15",
Solo == "Plintossolo" & Ciclo4 == "Tardio" & Caracteristica == "Neutro" ~ "G16",
.default = "outro"
)) |>
mutate(Grupo = factor(Grupo, levels = c("G1", "G2", "G3", "G4", "G5", "G6", "G7", "G8", "G9",
"G10", "G11", "G12", "G13", "G14", "G15", "G16")))
# modelo misto com covar de Grupo
mod4.lme <- lme(fixed = kgha ~ Grupo, data = soybean_data, random = ~1|Cultivar)
summary(mod4.lme)
tseries::jarque.bera.test(residuals(mod4.lme))
car::leveneTest(residuals(mod4.lme) ~ Cultivar)
length(mod4.lme$coefficients$fixed)
# testando os coeficientes não significantes do mod4.lme
coefID <- c(4,8)
coefNAM <- names(fixef(mod4.lme)[coefID])
Cmatrix <- matrix(0,2,16)
Cmatrix[cbind(1:2,coefID)] <- 1
rownames(Cmatrix) <- coefNAM
GLH <- multcomp::glht(model = mod4.lme, linfct = Cmatrix)
summary(GLH) # coeficientes não significativos
# mod gls com interação tripla e variância no Cultivar
mod1.gls <- gls(model = kgha ~ Solo*Ciclo4*Caracteristica,
data = soybean_data, weights = varIdent(form = ~1|Cultivar))
summary(mod1.gls)
tseries::jarque.bera.test(residuals(mod1.gls))
boxplot(resid(mod1.gls, type = "normalized") ~ soybean_data$Cultivar, xlab="Cultivar", ylab="Resíduos")
# mod gls com covar de Grupo e variância no Cultivar
mod2.gls <- gls(model = kgha ~ Grupo, data = soybean_data, weights = varIdent(form = ~1|Cultivar))
summary(mod2.gls)
tseries::jarque.bera.test(residuals(mod2.gls))
boxplot(resid(mod2.gls, type = "normalized") ~ soybean_data$Cultivar, xlab="Cultivar", ylab="Resíduos")
n <- 100
graus_de_liberdade <- 10
dados_t <- rt(n, df = graus_de_liberdade)
# Traçar o histograma dos dados e a densidade da distribuição t de Student
hist(dados_t, freq = FALSE, main = "Histograma vs. Distribuição t de Student",
xlab = "Valor", ylab = "Densidade", xlim = c(-5, 5))
curve(dt(x, df = graus_de_liberdade), col = "blue", add = TRUE, lwd = 2, lty = 2)
legend("topright", legend = c("Dados", "Distribuição t de Student"),
col = c("black", "blue"), lty = c(1, 2), lwd = c(1, 2))
mean(soybean_data$kgha)
hist(soybean_data$kgha, freq = FALSE)
hist(soybean_data$kgha, freq = FALSE, main = "", xlab = "kgha")
curve(dt(x, df = mean(kgha)), col = "blue", add = TRUE)
curve(dt(x, df = mean(kgha)), col = "blue", add = TRUE, lwd = 2, lty = 2)
mean(kgha)
hist(soybean_data$kgha, freq = FALSE, main = "", xlab = "kgha")
curve(dt(x, df = mean(kgha)), col = "blue", add = TRUE, lwd = 2, lty = 2)
hist(soybean_data$kgha, freq = FALSE, main = "", xlab = "kgha")
lines(density(kgha))
density(kgha)
?ks.test
ks.test(x = kgha, y = "pt")
ks.test(x = kgha, y = "pt", 3)
median(kgha)
mean(kgha)
?df
?qqplor
?qqplot
qqplot(qt(ppoints(1000),df=mean(kgha)), kgha, cex=0.6,pch=19,
main="QQplot para t-Student",
xlab="t-Student")
qqline(x,distribution= function(p)qt(p,df=mean(kgha)),
prob=c(0.1,0.6),col=2)
qqline(kgha,distribution= function(p)qt(p,df=mean(kgha)),
prob=c(0.1,0.6),col=2)
?pt
?t.test
qqplot(qt(ppoints(1000),df=987), kgha, cex=0.6,pch=19,
main="QQplot para t-Student",
xlab="t-Student")
qqline(kgha,distribution= function(p)qt(p,df=987),
prob=c(0.1,0.6),col=2)
t.test(x = kgha)
summary(mod1.lme)
rm(list = ls())
library(xlsx)
library(tidyverse)
library(sp)
library(nlme)
# loading principal data file
main_data <- read.xlsx("Data/Dados - Produtividade em Latossolo e Plintossolo - 2018 a 2023.xlsx", sheetIndex = 1)
main_data <- main_data[,1:12]
soybean_data <- main_data |>
# removing accents
# removendo acentos
mutate_at(vars(Local, Textura.do.solo, Cultivar),
~stringi::stri_trans_general(.,"Latin-ASCII")) |>
# transforming categorical variables
# transformando variáveis categóricas
mutate_at(vars(Local,Solo,Cultivar, Textura.do.solo), as.factor) |>
mutate(Anoc = as.factor(Ano)) |>
#transforming the Date covariate
# transformando a covariável de Data
mutate_at(vars(Plantio), as.Date)
# correcting coordinates
soybean_data <- soybean_data |>
separate(Lat..e.Long., into = c("Latit", "Longit"), sep = ";") |>
mutate(Latit = case_when(
Local == "Pium" ~ "10°12' 58'' S",
Local == "Paraiso do Tocantins" ~ "10°11' 16.9'' S",
Local == "Pedro Afonso" ~ "08°58' 03'' S",
Local == "Aparecida do Rio Negro" ~ "09°57' 07'' S",
Local == "Lagoa da Confusao" ~ "10°47' 37'' S",
TRUE ~ as.character(Latit)
),
Longit = case_when(
Local == "Pium" ~ "49°15' 1.4'' W",
Local == "Paraiso do Tocantins" ~ "48°40' 54.6'' W",
Local == "Goiania" ~ "49°30' 11'' W",
Local == "Pedro Afonso" ~ "48°10' 29'' W",
Local == "Aparecida do Rio Negro" ~ "47°58' 19'' W",
Local == "Lagoa da Confusao" ~ "49°37' 25'' W",
TRUE ~ as.character(Longit)
)) |>
mutate(Latitude = char2dms(from = Latit,chd = "°", chm = "'", chs = "''")
|> as.numeric()) |>
mutate(Longitude = char2dms(from = Longit,chd = "°", chm = "'", chs = "''")
|> as.numeric())
# correcting planting dates
# corrigindo as datas de plantio
soybean_data <- soybean_data |>
mutate(Plantio = case_when(
Plantio == "2022-01-17" ~ as.Date("2022-11-17"),
Plantio == "2021-11-23" ~ as.Date("2022-11-23"),
TRUE ~ as.Date(Plantio)),
Colheita = Plantio+Ciclo)
# creating the harvest cycle categorical covariate
# criando a covariável categórica de ciclo de colheita
soybean_data <- soybean_data |>
mutate(Ciclo4 = cut(x = Ciclo, breaks = c(-Inf, 100, 110, 120, Inf),
labels = c("Super Precoce","Precoce","Medio","Tardio"))) |>
# creating an identifier
mutate(idCombi = as.factor(paste(Local, Ano, Ciclo4, sep = "_")),
id = as.numeric(idCombi))
# creating oceanic season variable
soybean_data <- soybean_data |>
mutate(Temp = case_when(
year(Plantio) == 2017 & month(Plantio) == 11 & year(Colheita) == 2018 & month(Colheita) == 3 ~ mean(-0.7,-0.8,-1.0,-0.9,-0.9,-0.7,-0.5),
year(Plantio) == 2017 & month(Plantio) == 11 & year(Colheita) == 2018 & month(Colheita) == 4 ~ mean(-0.7,-0.8,-1.0,-0.9,-0.9,-0.7,-0.5,-0.2),
year(Plantio) == 2017 & month(Plantio) == 11 & year(Colheita) == 2018 & month(Colheita) == 2 ~ mean(-0.7,-0.8,-1.0,-0.9,-0.9,-0.7),
year(Plantio) == 2017 & month(Plantio) == 12 & year(Colheita) == 2018 & month(Colheita) == 3 ~ mean(-0.8,-1.0,-0.9,-0.9,-0.7,-0.5),
year(Plantio) == 2017 & month(Plantio) == 12 & year(Colheita) == 2018 & month(Colheita) == 4 ~ mean(-0.8,-1.0,-0.9,-0.9,-0.7,-0.5,-0.2),
year(Plantio) == 2019 & month(Plantio) == 11 & year(Colheita) == 2020 & month(Colheita) == 2 ~ mean(0.3,0.5,0.5,0.5,0.5,0.4),
year(Plantio) == 2019 & month(Plantio) == 11 & year(Colheita) == 2020 & month(Colheita) == 3 ~ mean(0.3,0.5,0.5,0.5,0.5,0.4,0.2),
year(Plantio) == 2020 & month(Plantio) == 11 & year(Colheita) == 2021 & month(Colheita) == 2 ~ mean(-1.2,-1.3,-1.2,-1.0,-0.9,-0.8),
year(Plantio) == 2020 & month(Plantio) == 11 & year(Colheita) == 2021 & month(Colheita) == 3 ~ mean(-1.2,-1.3,-1.2,-1.0,-0.9,-0.8,-0.7),
year(Plantio) == 2021 & month(Plantio) == 10 & year(Colheita) == 2022 & month(Colheita) == 2 ~ mean(-0.7,-0.8,-1.0,-1.0,-1.0,-0.9,-1.0),
year(Plantio) == 2021 & month(Plantio) == 11 & year(Colheita) == 2022 & month(Colheita) == 3 ~ mean(-0.8,-1.0,-1.0,-1.0,-0.9,-1.0,-1.1),
year(Plantio) == 2022 & month(Plantio) == 11 & year(Colheita) == 2023 & month(Colheita) == 2 ~ mean(-1.0,-0.9,-0.8,-0.7,-0.4,-0.1),
year(Plantio) == 2022 & month(Plantio) == 11 & year(Colheita) == 2023 & month(Colheita) == 3 ~ mean(-1.0,-0.9,-0.8,-0.7,-0.4,-0.1,0.2),
)) |>
mutate(Caracteristica = cut(Temp, breaks = c(-2, -0.5, 0.5), labels = c("LaNina", "Neutro")))
# creating Group variable of interactions Solo, Ciclo and Caracteristica
soybean_data <- soybean_data |>
#mutate(tha = kgha/1000) |>
mutate(Grupo = case_when(
Solo == "Latossolo" & Ciclo4 == "Super Precoce" & Caracteristica == "LaNina" ~ "G1",
Solo == "Latossolo" & Ciclo4 == "Super Precoce" & Caracteristica == "Neutro" ~ "G2",
Solo == "Plintossolo" & Ciclo4 == "Super Precoce" & Caracteristica == "LaNina" ~ "G3",
Solo == "Plintossolo" & Ciclo4 == "Super Precoce" & Caracteristica == "Neutro" ~ "G4",
Solo == "Latossolo" & Ciclo4 == "Precoce" & Caracteristica == "LaNina" ~ "G5",
Solo == "Latossolo" & Ciclo4 == "Precoce" & Caracteristica == "Neutro" ~ "G6",
Solo == "Plintossolo" & Ciclo4 == "Precoce" & Caracteristica == "LaNina" ~ "G7",
Solo == "Plintossolo" & Ciclo4 == "Precoce" & Caracteristica == "Neutro" ~ "G8",
Solo == "Latossolo" & Ciclo4 == "Medio" & Caracteristica == "LaNina" ~ "G9",
Solo == "Latossolo" & Ciclo4 == "Medio" & Caracteristica == "Neutro" ~ "G10",
Solo == "Plintossolo" & Ciclo4 == "Medio" & Caracteristica == "LaNina" ~ "G11",
Solo == "Plintossolo" & Ciclo4 == "Medio" & Caracteristica == "Neutro" ~ "G12",
Solo == "Latossolo" & Ciclo4 == "Tardio" & Caracteristica == "LaNina" ~ "G13",
Solo == "Latossolo" & Ciclo4 == "Tardio" & Caracteristica == "Neutro" ~ "G14",
Solo == "Plintossolo" & Ciclo4 == "Tardio" & Caracteristica == "LaNina" ~ "G15",
Solo == "Plintossolo" & Ciclo4 == "Tardio" & Caracteristica == "Neutro" ~ "G16",
.default = "outro"
)) |>
mutate(Grupo = factor(Grupo, levels = c("G1", "G2", "G3", "G4", "G5", "G6", "G7", "G8", "G9",
"G10", "G11", "G12", "G13", "G14", "G15", "G16")))
# row number
soybean_data <- soybean_data |> mutate(nrow = 1:nrow(soybean_data))
#   bind_rows(soybean_data |> filter(Ano == 2021 & Solo == "Latossolo" & Cultivar == "CZ37B43IPRO")) |>
#   bind_rows(soybean_data |> filter(Ano == 2021 & Solo == "Latossolo" & Cultivar == "DM80I79IPRO"))|>
#   bind_rows(soybean_data |> filter(Ano == 2021 & Solo == "Latossolo" & Cultivar == "DM82I78IPRO")) |>
#   bind_rows(soybean_data |> filter(Ano == 2021 & Solo == "Latossolo" & Cultivar == "P98Y21IPRO"))  |>
#   bind_rows(soybean_data |> filter(Ano == 2021 & Solo == "Plintossolo" & Cultivar == "CZ37B43IPRO"))|>
#   bind_rows(soybean_data |> filter(Ano == 2020 & Solo == "Latossolo" & Cultivar == "M8644IPRO")) |>
#   bind_rows(soybean_data |> filter(Ano == 2020 & Solo == "Latossolo" & Cultivar == "M8644IPRO"))|>
#   bind_rows(soybean_data |> filter(Ano == 2020 & Solo == "Latossolo" & Cultivar == "W791")) |>
#   bind_rows(soybean_data |> filter(Local == "Aparecida do Rio Negro" & Ano == 2018 & Solo == "Latossolo" & Cultivar == "BRS230068"))
# write.csv(x = filtered_data, file = "Produtividade_Soja_Outliers.csv")
outliers <- c(240,325,250,252,265,269,285,289,316,374,498,499,547,770)
attach(soybean_data)
ggplot(soybean_data, aes(x = Caracteristica, y = kgha)) +
geom_boxplot() + facet_grid(Solo~Ciclo4) +
theme_light()
# excluding outliers from the dataset
soybean_data <- soybean_data[-c(265, 289, 316, 374, 770),]
ggplot(soybean_data, aes(x = Caracteristica, y = kgha)) +
geom_boxplot() + facet_grid(Solo~Ciclo4) +
theme_light()
# modelo misto com interações triplas
mod1.lme <- lme(fixed = kgha ~ Solo*Ciclo4*Caracteristica, data = soybean_data,
random = ~1|Cultivar)
# modelo misto com interações duplas
mod2.lme <- lme(fixed = kgha ~ Solo*Ciclo4 + Solo*Caracteristica + Ciclo4*Caracteristica,
data = soybean_data, random = ~1|Cultivar)
# modelo misto sem interação dupla do Solo com Característica
mod3.lme <- lme(fixed = kgha ~ Solo*Ciclo4 + Ciclo4*Caracteristica,
data = soybean_data, random = ~1|Cultivar)
# modelo misto com covar de Grupo
mod4.lme <- lme(fixed = kgha ~ Grupo, data = soybean_data, random = ~1|Cultivar)
# mod gls com interação tripla e variância no Cultivar
mod1.gls <- gls(model = kgha ~ Solo*Ciclo4*Caracteristica,
data = soybean_data, weights = varIdent(form = ~1|Cultivar))
# mod gls com covar de Grupo e variância no Cultivar
mod2.gls <- gls(model = kgha ~ Grupo, data = soybean_data, weights = varIdent(form = ~1|Cultivar))
summary(mod1.lm)
summary(mod1.lme)
View(soybean_data)
?cv
library(sjstats)
# coeficiente de variacao por experimento
cv = soybean_data |> group_by(id) |> summarise(cv(kgha))
cv
View(cv)
summary(mod1.lme)
summary(mod1.lme)
summary(mod2.lme)
summary(mod3.lme)
tseries::jarque.bera.test(residuals(mod3.lme))
car::leveneTest(residuals(mod3.lme) ~ Cultivar)
car::leveneTest(residuals(mod3.lme) ~ Cultivar)
car::leveneTest(residuals(mod3.lme) ~ soybean_data$Cultivar)
# modelo misto com covar de Grupo
mod4.lme <- lme(fixed = kgha ~ Grupo, data = soybean_data, random = ~1|Cultivar)
summary(mod4.lme)
# creating Group variable of interactions Solo, Ciclo and Caracteristica
soybean_data <- soybean_data |>
#mutate(tha = kgha/1000) |>
mutate(Grupo = case_when(
Solo == "Latossolo" & Ciclo4 == "Super Precoce" & Caracteristica == "LaNina" ~ "G1",
Solo == "Latossolo" & Ciclo4 == "Super Precoce" & Caracteristica == "Neutro" ~ "G2",
Solo == "Plintossolo" & Ciclo4 == "Super Precoce" & Caracteristica == "LaNina" ~ "G3",
Solo == "Plintossolo" & Ciclo4 == "Super Precoce" & Caracteristica == "Neutro" ~ "G1",
Solo == "Latossolo" & Ciclo4 == "Precoce" & Caracteristica == "LaNina" ~ "G5",
Solo == "Latossolo" & Ciclo4 == "Precoce" & Caracteristica == "Neutro" ~ "G6",
Solo == "Plintossolo" & Ciclo4 == "Precoce" & Caracteristica == "LaNina" ~ "G7",
Solo == "Plintossolo" & Ciclo4 == "Precoce" & Caracteristica == "Neutro" ~ "G1",
Solo == "Latossolo" & Ciclo4 == "Medio" & Caracteristica == "LaNina" ~ "G9",
Solo == "Latossolo" & Ciclo4 == "Medio" & Caracteristica == "Neutro" ~ "G10",
Solo == "Plintossolo" & Ciclo4 == "Medio" & Caracteristica == "LaNina" ~ "G11",
Solo == "Plintossolo" & Ciclo4 == "Medio" & Caracteristica == "Neutro" ~ "G12",
Solo == "Latossolo" & Ciclo4 == "Tardio" & Caracteristica == "LaNina" ~ "G13",
Solo == "Latossolo" & Ciclo4 == "Tardio" & Caracteristica == "Neutro" ~ "G14",
Solo == "Plintossolo" & Ciclo4 == "Tardio" & Caracteristica == "LaNina" ~ "G15",
Solo == "Plintossolo" & Ciclo4 == "Tardio" & Caracteristica == "Neutro" ~ "G16",
.default = "outro"
)) |>
mutate(Grupo = factor(Grupo, levels = c("G1", "G2", "G3", "G5", "G6", "G7", "G9",
"G10", "G11", "G12", "G13", "G14", "G15", "G16")))
# modelo misto com covar de Grupo
mod4.lme <- lme(fixed = kgha ~ Grupo, data = soybean_data, random = ~1|Cultivar)
summary(mod4.lme)
tseries::jarque.bera.test(residuals(mod4.lme))
car::leveneTest(residuals(mod4.lme) ~ Cultivar)
car::leveneTest(residuals(mod4.lme) ~ soybean_data$Cultivar)
hist(resid(mod4.lme))
# modelo misto com covar de Grupo
mod4.lme <- lme(fixed = log(kgha) ~ Grupo, data = soybean_data, random = ~1|Cultivar)
summary(mod4.lme)
tseries::jarque.bera.test(residuals(mod4.lme))
car::leveneTest(residuals(mod4.lme) ~ soybean_data$Cultivar)
summary(mod4.lme)
# modelo misto com covar de Grupo
mod4.lme <- lme(fixed = (kgha)^1/6 ~ Grupo, data = soybean_data, random = ~1|Cultivar)
summary(mod4.lme)
# modelo misto com covar de Grupo
mod4.lme <- lme(fixed = (kgha)^(1/6) ~ Grupo, data = soybean_data, random = ~1|Cultivar)
summary(mod4.lme)
tseries::jarque.bera.test(residuals(mod4.lme))
car::leveneTest(residuals(mod4.lme) ~ soybean_data$Cultivar)
# modelo misto com covar de Grupo
mod4.lme <- lme(fixed = (kgha)^(1/9) ~ Grupo, data = soybean_data, random = ~1|Cultivar)
summary(mod4.lme)
tseries::jarque.bera.test(residuals(mod4.lme))
# modelo misto com covar de Grupo
mod4.lme <- lme(fixed = (kgha)^(1/2) ~ Grupo, data = soybean_data, random = ~1|Cultivar)
tseries::jarque.bera.test(residuals(mod4.lme))
# modelo misto com covar de Grupo
mod4.lme <- lme(fixed = (kgha)^(0.2) ~ Grupo, data = soybean_data, random = ~1|Cultivar)
tseries::jarque.bera.test(residuals(mod4.lme))
shapiro.test(resid(mod4.lme))
# modelo misto com covar de Grupo
mod4.lme <- lme(fixed = (kgha)^(0.15) ~ Grupo, data = soybean_data, random = ~1|Cultivar)
tseries::jarque.bera.test(residuals(mod4.lme))
shapiro.test(resid(mod4.lme))
?glmm
??glmm
??glmer
summary(mod1.gls)
summary(mod2.gls)
# creating Group variable of interactions Solo, Ciclo and Caracteristica
soybean_data <- soybean_data |>
#mutate(tha = kgha/1000) |>
mutate(Grupo = case_when(
Solo == "Latossolo" & Ciclo4 == "Super Precoce" & Caracteristica == "LaNina" ~ "G1",
Solo == "Latossolo" & Ciclo4 == "Super Precoce" & Caracteristica == "Neutro" ~ "G2",
Solo == "Plintossolo" & Ciclo4 == "Super Precoce" & Caracteristica == "LaNina" ~ "G3",
Solo == "Plintossolo" & Ciclo4 == "Super Precoce" & Caracteristica == "Neutro" ~ "G1",
Solo == "Latossolo" & Ciclo4 == "Precoce" & Caracteristica == "LaNina" ~ "G5",
Solo == "Latossolo" & Ciclo4 == "Precoce" & Caracteristica == "Neutro" ~ "G6",
Solo == "Plintossolo" & Ciclo4 == "Precoce" & Caracteristica == "LaNina" ~ "G7",
Solo == "Plintossolo" & Ciclo4 == "Precoce" & Caracteristica == "Neutro" ~ "G8",
Solo == "Latossolo" & Ciclo4 == "Medio" & Caracteristica == "LaNina" ~ "G9",
Solo == "Latossolo" & Ciclo4 == "Medio" & Caracteristica == "Neutro" ~ "G10",
Solo == "Plintossolo" & Ciclo4 == "Medio" & Caracteristica == "LaNina" ~ "G11",
Solo == "Plintossolo" & Ciclo4 == "Medio" & Caracteristica == "Neutro" ~ "G12",
Solo == "Latossolo" & Ciclo4 == "Tardio" & Caracteristica == "LaNina" ~ "G13",
Solo == "Latossolo" & Ciclo4 == "Tardio" & Caracteristica == "Neutro" ~ "G14",
Solo == "Plintossolo" & Ciclo4 == "Tardio" & Caracteristica == "LaNina" ~ "G15",
Solo == "Plintossolo" & Ciclo4 == "Tardio" & Caracteristica == "Neutro" ~ "G16",
.default = "outro"
)) |>
mutate(Grupo = factor(Grupo, levels = c("G1", "G2", "G3", "G5", "G6", "G7", "G8", "G9",
"G10", "G11", "G12", "G13", "G14", "G15", "G16")))
# mod gls com covar de Grupo e variância no Cultivar
mod2.gls <- gls(model = kgha ~ Grupo, data = soybean_data, weights = varIdent(form = ~1|Cultivar))
summary(mod2.gls)
# creating Group variable of interactions Solo, Ciclo and Caracteristica
soybean_data <- soybean_data |>
#mutate(tha = kgha/1000) |>
mutate(Grupo = case_when(
Solo == "Latossolo" & Ciclo4 == "Super Precoce" & Caracteristica == "LaNina" ~ "G1",
Solo == "Latossolo" & Ciclo4 == "Super Precoce" & Caracteristica == "Neutro" ~ "G2",
Solo == "Plintossolo" & Ciclo4 == "Super Precoce" & Caracteristica == "LaNina" ~ "G3",
Solo == "Plintossolo" & Ciclo4 == "Super Precoce" & Caracteristica == "Neutro" ~ "G1",
Solo == "Latossolo" & Ciclo4 == "Precoce" & Caracteristica == "LaNina" ~ "G5",
Solo == "Latossolo" & Ciclo4 == "Precoce" & Caracteristica == "Neutro" ~ "G6",
Solo == "Plintossolo" & Ciclo4 == "Precoce" & Caracteristica == "LaNina" ~ "G1",
Solo == "Plintossolo" & Ciclo4 == "Precoce" & Caracteristica == "Neutro" ~ "G8",
Solo == "Latossolo" & Ciclo4 == "Medio" & Caracteristica == "LaNina" ~ "G9",
Solo == "Latossolo" & Ciclo4 == "Medio" & Caracteristica == "Neutro" ~ "G10",
Solo == "Plintossolo" & Ciclo4 == "Medio" & Caracteristica == "LaNina" ~ "G11",
Solo == "Plintossolo" & Ciclo4 == "Medio" & Caracteristica == "Neutro" ~ "G12",
Solo == "Latossolo" & Ciclo4 == "Tardio" & Caracteristica == "LaNina" ~ "G13",
Solo == "Latossolo" & Ciclo4 == "Tardio" & Caracteristica == "Neutro" ~ "G14",
Solo == "Plintossolo" & Ciclo4 == "Tardio" & Caracteristica == "LaNina" ~ "G15",
Solo == "Plintossolo" & Ciclo4 == "Tardio" & Caracteristica == "Neutro" ~ "G16",
.default = "outro"
)) |>
mutate(Grupo = factor(Grupo, levels = c("G1", "G2", "G3", "G5", "G6", "G8", "G9",
"G10", "G11", "G12", "G13", "G14", "G15", "G16")))
# mod gls com covar de Grupo e variância no Cultivar
mod2.gls <- gls(model = kgha ~ Grupo, data = soybean_data, weights = varIdent(form = ~1|Cultivar))
summary(mod2.gls)
# creating Group variable of interactions Solo, Ciclo and Caracteristica
soybean_data <- soybean_data |>
#mutate(tha = kgha/1000) |>
mutate(Grupo = case_when(
Solo == "Latossolo" & Ciclo4 == "Super Precoce" & Caracteristica == "LaNina" ~ "G1",
Solo == "Latossolo" & Ciclo4 == "Super Precoce" & Caracteristica == "Neutro" ~ "G2",
Solo == "Plintossolo" & Ciclo4 == "Super Precoce" & Caracteristica == "LaNina" ~ "G3",
Solo == "Plintossolo" & Ciclo4 == "Super Precoce" & Caracteristica == "Neutro" ~ "G1",
Solo == "Latossolo" & Ciclo4 == "Precoce" & Caracteristica == "LaNina" ~ "G5",
Solo == "Latossolo" & Ciclo4 == "Precoce" & Caracteristica == "Neutro" ~ "G6",
Solo == "Plintossolo" & Ciclo4 == "Precoce" & Caracteristica == "LaNina" ~ "G1",
Solo == "Plintossolo" & Ciclo4 == "Precoce" & Caracteristica == "Neutro" ~ "G1",
Solo == "Latossolo" & Ciclo4 == "Medio" & Caracteristica == "LaNina" ~ "G9",
Solo == "Latossolo" & Ciclo4 == "Medio" & Caracteristica == "Neutro" ~ "G10",
Solo == "Plintossolo" & Ciclo4 == "Medio" & Caracteristica == "LaNina" ~ "G11",
Solo == "Plintossolo" & Ciclo4 == "Medio" & Caracteristica == "Neutro" ~ "G12",
Solo == "Latossolo" & Ciclo4 == "Tardio" & Caracteristica == "LaNina" ~ "G13",
Solo == "Latossolo" & Ciclo4 == "Tardio" & Caracteristica == "Neutro" ~ "G14",
Solo == "Plintossolo" & Ciclo4 == "Tardio" & Caracteristica == "LaNina" ~ "G15",
Solo == "Plintossolo" & Ciclo4 == "Tardio" & Caracteristica == "Neutro" ~ "G16",
.default = "outro"
)) |>
mutate(Grupo = factor(Grupo, levels = c("G1", "G2", "G3", "G5", "G6", "G9",
"G10", "G11", "G12", "G13", "G14", "G15", "G16")))
# mod gls com covar de Grupo e variância no Cultivar
mod2.gls <- gls(model = kgha ~ Grupo, data = soybean_data, weights = varIdent(form = ~1|Cultivar))
summary(mod2.gls)
tseries::jarque.bera.test(residuals(mod2.gls))
tseries::jarque.bera.test(resid(mod2.gls))
shapiro.test(resid(mod2.gls))
mod1.glmm <- lme4::glmer(formula = kgha ~ Solo*Ciclo4*Caracteristica + (1|Cultivar),
data = soybean_data, family = gaussian(link = "log")))
# modelo misto com covar de Grupo
mod4.lme <- lme(fixed = log(log(kgha)) ~ Grupo, data = soybean_data, random = ~1|Cultivar)
tseries::jarque.bera.test(residuals(mod4.lme))
summary(mod4.lme)
shapiro.test(resid(mod4.lme))
mod1.glmm <- lme4::glmer(formula = kgha ~ Solo*Ciclo4*Caracteristica + (1|Cultivar),
data = soybean_data, family = gaussian(link = "log"))
summary(mod1.glmm)
